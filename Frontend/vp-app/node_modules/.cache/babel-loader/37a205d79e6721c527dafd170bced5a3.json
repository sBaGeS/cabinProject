{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pauli\\\\Desktop\\\\groupC\\\\Frontend\\\\vp-app\\\\src\\\\components\\\\editReservation\\\\EditReservationDialog.js\";\nimport React, { useState, useEffect } from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport NativeSelect from '@material-ui/core/NativeSelect';\nimport { getToken, getUserId } from '../../Utils/Common';\nimport axios from 'axios';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nimport dateFormat from 'dateformat';\nconst useStyles = makeStyles(theme => ({\n  formRoot: {\n    '& .MuiTextField-root': {\n      margin: theme.spacing(1),\n      width: '25ch'\n    }\n  },\n  Infotxt: {\n    color: 'yellow'\n  }\n}));\nexport default function EditReservationDialog(props) {\n  const token = getToken();\n  const classes = useStyles();\n  const [dialogOpen, setDialogOpen] = useState(true);\n  const startDateParts = props.arrivaldate.split(\"/\");\n  const endDateParts = props.leavedate.split(\"/\");\n  const startDate = new Date(startDateParts[1] + \"/\" + startDateParts[0] + \"/\" + startDateParts[2]);\n  const endDate = new Date(endDateParts[1] + \"/\" + endDateParts[0] + \"/\" + endDateParts[2]);\n  const [arrivaldate, setArrivaldate] = useState(startDate);\n  const [leavedate, setLeavedate] = useState(endDate);\n  const [people, setPeople] = useState(props.people);\n  const [peopleErrorMsg, setPeopleErrorMsg] = useState(\"\");\n  const [pets, setPets] = useState(props.pets);\n  const [serverErrorMsg, setServerErrorMsg] = useState(\"\");\n\n  const date_diff_indays = function (date1, date2) {\n    let dt1 = new Date(date1);\n    let dt2 = new Date(date2);\n    return Math.floor((Date.UTC(dt2.getFullYear(), dt2.getMonth(), dt2.getDate()) - Date.UTC(dt1.getFullYear(), dt1.getMonth(), dt1.getDate())) / (1000 * 60 * 60 * 24));\n  };\n\n  const [price, setPrice] = useState(props.price / date_diff_indays(arrivaldate, leavedate));\n\n  const axiosPutReservation = () => {\n    let new_price = date_diff_indays(arrivaldate, leavedate) * price;\n    axios.put('http://localhost:3001/reservation/' + props.id, {\n      arrivaldate: dateFormat(arrivaldate, \"yyyy-mm-dd\"),\n      leavedate: dateFormat(leavedate, \"yyyy-mm-dd\"),\n      people: people,\n      pets: pets,\n      cabin_id: props.cabinId,\n      price: new_price\n    }, {\n      headers: {\n        token: token\n      }\n    }).then(function (response) {\n      console.log(response);\n      setDialogOpen(false);\n      props.edit(false);\n      window.location.reload();\n    }).catch(function (error) {\n      console.log(error.response);\n      setServerErrorMsg(error.response.data.msg);\n      setTimeout(() => {\n        setServerErrorMsg(\"\");\n      }, 3500);\n    });\n  };\n\n  const handleClose = () => {\n    setDialogOpen(false);\n    props.edit(false);\n  };\n\n  const handleEditClicked = () => {\n    let peopleValidationError = false;\n\n    if (people <= 0 || people == \"\") {\n      setPeopleErrorMsg(\"Please insert the number of people\");\n      peopleValidationError = true;\n    } else {\n      peopleValidationError = false;\n      setPeopleErrorMsg(\"\");\n    }\n\n    if (peopleValidationError === false) {\n      axiosPutReservation();\n    }\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(Dialog, {\n    open: dialogOpen,\n    onClose: handleClose,\n    \"aria-labelledby\": \"form-dialog-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, React.createElement(DialogTitle, {\n    id: \"form-dialog-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, \"Edit reservation info\"), React.createElement(DialogContent, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    className: classes.formRoot,\n    noValidate: true,\n    autoComplete: \"off\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    error: peopleErrorMsg != \"\",\n    helperText: peopleErrorMsg,\n    required: true,\n    id: \"people\",\n    label: \"People\",\n    value: people,\n    type: \"number\",\n    onChange: e => {\n      setPeople(parseInt(e.target.value, 10));\n      e.target.value.length === 0 ? setPeopleErrorMsg(\"Please insert the number of people\") : setPeopleErrorMsg(\"\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    style: {\n      display: \"flex\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    style: {\n      marginTop: 6,\n      marginLeft: 10\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, \"Pets\"), React.createElement(NativeSelect, {\n    required: true,\n    id: \"pets\",\n    label: \"Pets\",\n    defaultValue: props.pets,\n    onChange: e => {\n      setPets(parseInt(e.target.value, 10));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    value: \"1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"Yes\"), React.createElement(\"option\", {\n    value: \"0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, \"No\"))), React.createElement(\"div\", {\n    style: {\n      marginTop: 30,\n      marginLeft: 10\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, React.createElement(MuiPickersUtilsProvider, {\n    utils: DateFnsUtils,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"dd/MM/yyyy\",\n    margin: \"normal\",\n    id: \"start_date\",\n    label: \"Check in\",\n    disablePast: \"true\",\n    value: arrivaldate,\n    onChange: date => setArrivaldate(date),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }), React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"dd/MM/yyyy\",\n    margin: \"normal\",\n    id: \"end_date\",\n    label: \"Check out\",\n    disablePast: \"true\",\n    value: leavedate,\n    onChange: date => setLeavedate(date),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  })))))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    style: {\n      color: \"red\",\n      fontWeight: 900,\n      fontSize: 14,\n      marginLeft: 110\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, serverErrorMsg), React.createElement(DialogActions, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }, React.createElement(Button, {\n    variant: \"contained\",\n    onClick: () => handleEditClicked(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }, \"Edit\"), React.createElement(Button, {\n    variant: \"contained\",\n    onClick: () => handleClose(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }, \"Cancel\")))));\n}","map":{"version":3,"sources":["C:/Users/Pauli/Desktop/groupC/Frontend/vp-app/src/components/editReservation/EditReservationDialog.js"],"names":["React","useState","useEffect","TextField","makeStyles","Button","Dialog","DialogActions","DialogContent","DialogTitle","NativeSelect","getToken","getUserId","axios","MuiPickersUtilsProvider","KeyboardDatePicker","DateFnsUtils","dateFormat","useStyles","theme","formRoot","margin","spacing","width","Infotxt","color","EditReservationDialog","props","token","classes","dialogOpen","setDialogOpen","startDateParts","arrivaldate","split","endDateParts","leavedate","startDate","Date","endDate","setArrivaldate","setLeavedate","people","setPeople","peopleErrorMsg","setPeopleErrorMsg","pets","setPets","serverErrorMsg","setServerErrorMsg","date_diff_indays","date1","date2","dt1","dt2","Math","floor","UTC","getFullYear","getMonth","getDate","price","setPrice","axiosPutReservation","new_price","put","id","cabin_id","cabinId","headers","then","response","console","log","edit","window","location","reload","catch","error","data","msg","setTimeout","handleClose","handleEditClicked","peopleValidationError","e","parseInt","target","value","length","display","marginTop","marginLeft","date","fontWeight","fontSize"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport NativeSelect from '@material-ui/core/NativeSelect';\r\nimport {getToken, getUserId} from '../../Utils/Common';\r\nimport axios from 'axios';\r\nimport {MuiPickersUtilsProvider,KeyboardDatePicker} from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport dateFormat from 'dateformat';\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    formRoot: {\r\n        '& .MuiTextField-root': {\r\n            margin: theme.spacing(1),\r\n            width: '25ch',\r\n        }\r\n    },\r\n    Infotxt: {\r\n        color: 'yellow',\r\n    }\r\n}));\r\n\r\nexport default function EditReservationDialog(props) {\r\n\r\n    const token = getToken();\r\n    \r\n    const classes = useStyles();\r\n    const [dialogOpen, setDialogOpen] = useState(true);\r\n\r\n    const startDateParts = props.arrivaldate.split(\"/\");\r\n    const endDateParts = props.leavedate.split(\"/\");\r\n\r\n    const startDate = new Date(startDateParts[1] + \"/\" + startDateParts[0] + \"/\" + startDateParts[2]);\r\n    const endDate = new Date(endDateParts[1] + \"/\" + endDateParts[0] + \"/\" + endDateParts[2]);\r\n\r\n    const [arrivaldate, setArrivaldate] = useState(startDate);\r\n    const [leavedate, setLeavedate] = useState(endDate);\r\n    const [people, setPeople] = useState(props.people);\r\n    const [peopleErrorMsg, setPeopleErrorMsg] = useState(\"\");\r\n    const [pets, setPets] = useState(props.pets);\r\n \r\n    const [serverErrorMsg, setServerErrorMsg] = useState(\"\");\r\n\r\n    const date_diff_indays = function(date1, date2) {\r\n        let dt1 = new Date(date1);\r\n        let dt2 = new Date(date2);\r\n        return Math.floor((Date.UTC(dt2.getFullYear(), dt2.getMonth(), dt2.getDate()) - Date.UTC(dt1.getFullYear(), dt1.getMonth(), dt1.getDate()) ) /(1000 * 60 * 60 * 24));\r\n        }\r\n\r\n        const [price, setPrice] = useState(props.price / date_diff_indays(arrivaldate, leavedate));\r\n\r\n    const axiosPutReservation = () => {\r\n\r\n        let new_price = date_diff_indays(arrivaldate, leavedate) * price;\r\n\r\n        axios.put('http://localhost:3001/reservation/'+ props.id, {\r\n\r\n            arrivaldate: dateFormat(arrivaldate, \"yyyy-mm-dd\"),\r\n            leavedate: dateFormat(leavedate, \"yyyy-mm-dd\"),\r\n            people: people,\r\n            pets: pets,\r\n            cabin_id: props.cabinId,\r\n            price: new_price,\r\n        },\r\n            {\r\n                headers: {\r\n                    token: token\r\n                }\r\n            })\r\n            .then(function (response) {\r\n                console.log(response);\r\n                setDialogOpen(false);\r\n                props.edit(false);\r\n                window.location.reload();\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error.response);\r\n                setServerErrorMsg(error.response.data.msg);\r\n                setTimeout(() => {\r\n                  setServerErrorMsg(\"\");\r\n                }, 3500);\r\n            });\r\n    }\r\n\r\n    const handleClose = () => {\r\n        setDialogOpen(false);\r\n        props.edit(false);\r\n    };\r\n\r\n    const handleEditClicked = () => {\r\n        let peopleValidationError = false;\r\n\r\n        if (people <= 0 || people == \"\") {\r\n            setPeopleErrorMsg(\"Please insert the number of people\");\r\n            peopleValidationError = true;\r\n        }\r\n        else {\r\n            peopleValidationError = false;\r\n            setPeopleErrorMsg(\"\");\r\n        }\r\n\r\n        if (peopleValidationError === false) {\r\n            axiosPutReservation();\r\n        }\r\n    }\r\n\r\nreturn (\r\n    <div>\r\n        <Dialog open={dialogOpen} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\r\n            <DialogTitle id=\"form-dialog-title\">Edit reservation info</DialogTitle>\r\n            <DialogContent>\r\n            <form className={classes.formRoot} noValidate autoComplete=\"off\">\r\n            <TextField error={peopleErrorMsg != \"\"} helperText={peopleErrorMsg} required id=\"people\" label=\"People\" value={people}\r\n                    type=\"number\"\r\n                    onChange={(e) => {\r\n                        setPeople(parseInt(e.target.value, 10));\r\n                        (e.target.value.length === 0) ? setPeopleErrorMsg(\"Please insert the number of people\") : setPeopleErrorMsg(\"\")\r\n                    }} />\r\n            <div style={{display: \"flex\"}}> \r\n            <div style={{marginTop: 6, marginLeft: 10}}>\r\n            <p>Pets</p>\r\n            <NativeSelect\r\n                 required id=\"pets\" label=\"Pets\" defaultValue={props.pets}\r\n                  onChange={(e) => {\r\n                      setPets(parseInt(e.target.value, 10));\r\n                  }}>\r\n                 <option value=\"1\">Yes</option>\r\n                 <option value=\"0\">No</option>\r\n                </NativeSelect>\r\n                </div>\r\n\r\n                <div style={{marginTop: 30, marginLeft: 10}}>\r\n            <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n            <KeyboardDatePicker\r\n          disableToolbar\r\n          variant=\"inline\"\r\n          format=\"dd/MM/yyyy\"\r\n          margin=\"normal\"\r\n          id=\"start_date\"\r\n          label=\"Check in\"\r\n          disablePast = \"true\"\r\n          value={arrivaldate}\r\n          onChange={(date) => setArrivaldate(date)}\r\n          KeyboardButtonProps={{\r\n            'aria-label': 'change date',\r\n          }}\r\n        />\r\n        \r\n         <KeyboardDatePicker\r\n          disableToolbar\r\n          variant=\"inline\"\r\n          format=\"dd/MM/yyyy\"\r\n          margin=\"normal\"\r\n          id=\"end_date\"\r\n          label=\"Check out\"\r\n          disablePast = \"true\"\r\n          value={leavedate}\r\n          onChange={(date) => setLeavedate(date)}\r\n          KeyboardButtonProps={{\r\n            'aria-label': 'change date',\r\n          }}\r\n        />\r\n         </MuiPickersUtilsProvider>\r\n            </div>\r\n\r\n\r\n            </div>\r\n            </form>\r\n            </DialogContent>\r\n\r\n            <div>\r\n                <p style={{ color: \"red\", fontWeight: 900, fontSize: 14, marginLeft: 110 }}>{serverErrorMsg}</p>\r\n\r\n                <DialogActions>\r\n                    <Button variant=\"contained\" onClick={() => handleEditClicked()}>Edit</Button>\r\n                    <Button variant=\"contained\" onClick={() => handleClose()}>Cancel</Button>\r\n                </DialogActions>\r\n            </div>\r\n        </Dialog>\r\n    </div>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}