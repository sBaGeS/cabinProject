{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pauli\\\\Desktop\\\\groupC\\\\Frontend\\\\vp-app\\\\src\\\\components\\\\getCabinReport\\\\GetCabinReport.js\";\nimport React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport GetAgencies from '../getAgencies/GetAgencies';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nimport Box from '@material-ui/core/Box';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport axios from 'axios';\nimport { getToken, getUserId, getAdmin } from '../../Utils/Common';\nimport dateFormat from 'dateformat';\nconst useStyles = makeStyles(() => ({\n  searchButton: {\n    marginTop: 5,\n    backgroundColor: 'navy',\n    color: 'white',\n    '&:hover': {\n      background: \"white\",\n      color: 'navy'\n    }\n  },\n  datePicker: {\n    marginTop: 5,\n    marginBottom: 5\n  }\n}));\nconst defaultProps = {\n  bgcolor: 'background.paper',\n  m: 1,\n  border: 2,\n  padding: 2,\n  borderRadius: 16,\n  borderColor: 'navy'\n};\nexport default function GetCabinReport(props) {\n  const classes = useStyles();\n  const [cabinReport, setCabinReport] = useState([]);\n  const [agencyId, setAgencyId] = useState(\"\");\n  const [agencyErrorMsg, setAgencyErrorMsg] = useState(\"\");\n  const [serverErrorMsg, setServerErrorMsg] = useState(\"\");\n  const [arrivaldate, setArrivaldate] = useState();\n  const [leavedate, setLeavedate] = useState();\n  const startDate = dateFormat(arrivaldate, \"yyyy-mm-dd\");\n  const endDate = dateFormat(leavedate, \"yyyy-mm-dd\");\n  const [reservationSum, setReservationSum] = useState(0);\n  const [loaded, setLoaded] = useState(false);\n  let reportElement = \"\";\n  let token = getToken();\n\n  const axiosGetCabinReport = query => {\n    axios.get(\"http://localhost:3001/reservationreport?\" + query, {\n      headers: {\n        token: token\n      }\n    }).then(function (response) {\n      console.log(response);\n      setCabinReport(response.data.reservationReport);\n      setLoaded(true);\n    }).catch(function (error) {\n      console.log(error);\n      setServerErrorMsg(error);\n    });\n  };\n  /*const date_diff_indays = function(date1, date2) {\r\n      let dt1 = new Date(date1);\r\n      let dt2 = new Date(date2);\r\n      return Math.floor((Date.UTC(dt2.getFullYear(), dt2.getMonth(), dt2.getDate()) - Date.UTC(dt1.getFullYear(), dt1.getMonth(), dt1.getDate()) ) /(1000 * 60 * 60 * 24));\r\n      }\r\n  if (loaded) {\r\n      let sum = 0;\r\n      \r\n      for (let i = 0; i < cabinReport.length; i++) {\r\n         console.log(parseInt(cabinReport[i].arrivaldate));\r\n          sum += cabinReport[i].price *  date_diff_indays(cabinReport[i].arrivaldate, cabinReport[i].leavedate);\r\n      }\r\n      setReservationSum(sum);\r\n      console.log(sum);\r\n      setLoaded(false);\r\n  }*/\n\n\n  const handlePostClicked = () => {\n    let query = \"\";\n    let agencyError;\n\n    if (agencyId == \"\") {\n      agencyError = true;\n      setAgencyErrorMsg(\"Please select an agency\");\n    } else {\n      query += \"agency_id=\" + agencyId + \"&\";\n      agencyError = false;\n      setAgencyErrorMsg(\"\");\n    }\n\n    if (startDate != \"\" && endDate != \"\") {\n      query += \"startDate=\" + startDate + \"&endDate=\" + endDate;\n    }\n\n    if (!getAdmin()) {\n      query += \"&person_id=\" + getUserId();\n    }\n\n    if (!agencyError) {\n      axiosGetCabinReport(query);\n    }\n  };\n\n  if (cabinReport.length !== 0) {\n    reportElement = React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      style: {\n        color: \"green\",\n        fontWeight: 900,\n        fontSize: 16\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"Reservations: \", cabinReport.length));\n  }\n\n  return React.createElement(Box, Object.assign({\n    borderColor: \"navy\"\n  }, defaultProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }), React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, \"Cabin Reports\"), React.createElement(\"div\", {\n    style: {\n      display: \"flex\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, React.createElement(GetAgencies, {\n    agencyId: agencyId,\n    setAgencyId: setAgencyId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }), React.createElement(Paper, {\n    className: classes.datePicker,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, React.createElement(MuiPickersUtilsProvider, {\n    utils: DateFnsUtils,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"dd/MM/yyyy\",\n    margin: \"normal\",\n    id: \"start_date\",\n    label: \"Start date\",\n    value: startDate,\n    onChange: date => setArrivaldate(date),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }), React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"dd/MM/yyyy\",\n    margin: \"normal\",\n    id: \"end_date\",\n    label: \"End date\",\n    value: endDate,\n    onChange: date => setLeavedate(date),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  })), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  })))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, React.createElement(Button, {\n    variant: \"contained\",\n    className: classes.searchButton,\n    onClick: () => handlePostClicked(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, \"Search\"), React.createElement(\"p\", {\n    style: {\n      color: \"red\",\n      fontWeight: 900,\n      fontSize: 16,\n      marginLeft: 130\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, serverErrorMsg, agencyErrorMsg)), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, React.createElement(TableContainer, {\n    component: Paper,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, React.createElement(Table, {\n    className: classes.table,\n    \"aria-label\": \"customized table\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, React.createElement(TableHead, {\n    className: classes.tableHeader,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179\n    },\n    __self: this\n  }, React.createElement(TableRow, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }, React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }, \"Cabin Name\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }, \"Customer\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, \"Price\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, \"Agency\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, \"Number of ppl\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, \"Arrival Date\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, \"Departure Date\"))), React.createElement(TableBody, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }, cabinReport.map((report, i) => React.createElement(TableRow, {\n    key: i,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }, React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, report.cabin), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, report.firstname, \" \", report.lastname), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }, report.cabin_price, \"\\u20AC\"), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195\n    },\n    __self: this\n  }, report.agency), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196\n    },\n    __self: this\n  }, report.people), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  }, report.arrivaldate), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198\n    },\n    __self: this\n  }, report.leavedate)))))), reportElement));\n}","map":{"version":3,"sources":["C:/Users/Pauli/Desktop/groupC/Frontend/vp-app/src/components/getCabinReport/GetCabinReport.js"],"names":["React","useState","useEffect","makeStyles","Button","GetAgencies","MuiPickersUtilsProvider","KeyboardDatePicker","DateFnsUtils","Box","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","axios","getToken","getUserId","getAdmin","dateFormat","useStyles","searchButton","marginTop","backgroundColor","color","background","datePicker","marginBottom","defaultProps","bgcolor","m","border","padding","borderRadius","borderColor","GetCabinReport","props","classes","cabinReport","setCabinReport","agencyId","setAgencyId","agencyErrorMsg","setAgencyErrorMsg","serverErrorMsg","setServerErrorMsg","arrivaldate","setArrivaldate","leavedate","setLeavedate","startDate","endDate","reservationSum","setReservationSum","loaded","setLoaded","reportElement","token","axiosGetCabinReport","query","get","headers","then","response","console","log","data","reservationReport","catch","error","handlePostClicked","agencyError","length","fontWeight","fontSize","display","date","marginLeft","table","tableHeader","tableHeaderCell","map","report","i","cabin","firstname","lastname","cabin_price","agency","people"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport GetAgencies from '../getAgencies/GetAgencies';\r\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport Box from '@material-ui/core/Box';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport axios from 'axios';\r\nimport { getToken,getUserId, getAdmin } from '../../Utils/Common';\r\nimport dateFormat from 'dateformat';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    searchButton: {\r\n        marginTop: 5,\r\n        backgroundColor: 'navy',\r\n        color: 'white',\r\n        '&:hover': {\r\n            background: \"white\",\r\n            color: 'navy',\r\n        },\r\n    },\r\n    datePicker: {\r\n        marginTop: 5,\r\n        marginBottom: 5\r\n    }\r\n}));\r\nconst defaultProps = {\r\n    bgcolor: 'background.paper',\r\n    m: 1,\r\n    border: 2,\r\n    padding: 2,\r\n    borderRadius: 16,\r\n    borderColor: 'navy'\r\n\r\n};\r\n\r\nexport default function GetCabinReport(props) {\r\n\r\n    const classes = useStyles();\r\n\r\n    const [cabinReport, setCabinReport] = useState([]);\r\n    const [agencyId, setAgencyId] = useState(\"\");\r\n\r\n    const [agencyErrorMsg, setAgencyErrorMsg] = useState(\"\");\r\n    const [serverErrorMsg, setServerErrorMsg] = useState(\"\");\r\n\r\n    const [arrivaldate, setArrivaldate] = useState();\r\n    const [leavedate, setLeavedate] = useState();\r\n\r\n    const startDate = dateFormat(arrivaldate, \"yyyy-mm-dd\");\r\n    const endDate = dateFormat(leavedate, \"yyyy-mm-dd\");\r\n\r\n    const [reservationSum, setReservationSum] = useState(0);\r\n    const [loaded, setLoaded] = useState(false);\r\n\r\n    let reportElement = \"\";\r\n    let token = getToken();\r\n\r\n \r\n\r\n    const axiosGetCabinReport = (query) => {\r\n        axios.get(\"http://localhost:3001/reservationreport?\" + query, {\r\n            headers: {\r\n                token: token\r\n            }\r\n        }).then(function (response) {\r\n            console.log(response);\r\n            setCabinReport(response.data.reservationReport);\r\n            setLoaded(true);\r\n        })\r\n            .catch(function (error) {\r\n                console.log(error);\r\n                setServerErrorMsg(error);\r\n            })\r\n    }\r\n    /*const date_diff_indays = function(date1, date2) {\r\n        let dt1 = new Date(date1);\r\n        let dt2 = new Date(date2);\r\n        return Math.floor((Date.UTC(dt2.getFullYear(), dt2.getMonth(), dt2.getDate()) - Date.UTC(dt1.getFullYear(), dt1.getMonth(), dt1.getDate()) ) /(1000 * 60 * 60 * 24));\r\n        }\r\n    if (loaded) {\r\n        let sum = 0;\r\n        \r\n        for (let i = 0; i < cabinReport.length; i++) {\r\n           console.log(parseInt(cabinReport[i].arrivaldate));\r\n            sum += cabinReport[i].price *  date_diff_indays(cabinReport[i].arrivaldate, cabinReport[i].leavedate);\r\n        }\r\n        setReservationSum(sum);\r\n        console.log(sum);\r\n        setLoaded(false);\r\n    }*/\r\n    \r\n\r\n    const handlePostClicked = () => {\r\n        let query = \"\";\r\n        let agencyError;\r\n\r\n        if (agencyId == \"\") {\r\n            agencyError = true;\r\n            setAgencyErrorMsg(\"Please select an agency\");\r\n        }\r\n        else {\r\n            query += \"agency_id=\" + agencyId + \"&\";\r\n            agencyError = false;\r\n            setAgencyErrorMsg(\"\");\r\n        }\r\n        if (startDate != \"\" && endDate != \"\") {\r\n\r\n            query += \"startDate=\" + startDate + \"&endDate=\" + endDate;\r\n        }\r\n        if(!getAdmin()){\r\n            query += \"&person_id=\" + getUserId();\r\n        }\r\n        if (!agencyError) {\r\n            axiosGetCabinReport(query);\r\n        }\r\n    }\r\n\r\n    if (cabinReport.length !== 0) {\r\n        reportElement = <div>\r\n            <p style={{ color: \"green\", fontWeight: 900, fontSize: 16 }}>Reservations: {cabinReport.length}</p>\r\n        </div>\r\n    }\r\n\r\n    return (\r\n\r\n        <Box borderColor=\"navy\" {...defaultProps}>\r\n            <h2>Cabin Reports</h2>\r\n            <div style={{ display: \"flex\" }}>\r\n                <div>\r\n                    <GetAgencies agencyId={agencyId} setAgencyId={setAgencyId} />\r\n                    <br />\r\n                    <Paper className={classes.datePicker}>\r\n                        <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n                            <KeyboardDatePicker\r\n                                disableToolbar\r\n                                variant=\"inline\"\r\n                                format=\"dd/MM/yyyy\"\r\n                                margin=\"normal\"\r\n                                id=\"start_date\"\r\n                                label=\"Start date\"\r\n                                value={startDate}\r\n                                onChange={(date) => setArrivaldate(date)}\r\n                                KeyboardButtonProps={{\r\n                                    'aria-label': 'change date',\r\n                                }}\r\n                            />\r\n                            <KeyboardDatePicker\r\n                                disableToolbar\r\n                                variant=\"inline\"\r\n                                format=\"dd/MM/yyyy\"\r\n                                margin=\"normal\"\r\n                                id=\"end_date\"\r\n                                label=\"End date\"\r\n                                value={endDate}\r\n                                onChange={(date) => setLeavedate(date)}\r\n                                KeyboardButtonProps={{\r\n                                    'aria-label': 'change date',\r\n                                }}\r\n                            />\r\n                        </MuiPickersUtilsProvider><br />\r\n                    </Paper>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <Button variant=\"contained\" className={classes.searchButton} onClick={() => handlePostClicked()}>Search</Button>\r\n                <p style={{ color: \"red\", fontWeight: 900, fontSize: 16, marginLeft: 130 }}>{serverErrorMsg}{agencyErrorMsg}</p>\r\n            </div>\r\n            <div>\r\n                <TableContainer component={Paper}>\r\n                    <Table className={classes.table} aria-label=\"customized table\">\r\n                        <TableHead className={classes.tableHeader}>\r\n                            <TableRow>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Cabin Name</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Customer</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Price</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Agency</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Number of ppl</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Arrival Date</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Departure Date</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableBody>\r\n                            {cabinReport.map((report, i) => <TableRow key={i}>\r\n                                <TableCell align=\"left\">{report.cabin}</TableCell>\r\n                                <TableCell align=\"left\">{report.firstname} {report.lastname}</TableCell>\r\n                                <TableCell align=\"left\">{report.cabin_price}€</TableCell>\r\n                                <TableCell align=\"left\">{report.agency}</TableCell>\r\n                                <TableCell align=\"left\">{report.people}</TableCell>\r\n                                <TableCell align=\"left\">{report.arrivaldate}</TableCell>\r\n                                <TableCell align=\"left\">{report.leavedate}</TableCell>\r\n                            </TableRow>)}\r\n                        </TableBody>\r\n                    </Table>\r\n                </TableContainer>\r\n                {reportElement}\r\n            </div>\r\n        </Box>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}