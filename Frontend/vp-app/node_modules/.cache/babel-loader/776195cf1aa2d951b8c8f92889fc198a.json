{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pauli\\\\Desktop\\\\groupC\\\\Frontend\\\\vp-app\\\\src\\\\components\\\\getServiceReport\\\\GetServiceReport.js\";\nimport React, { useState, useEffect } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport GetAgencies from '../getAgencies/GetAgencies';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nimport Box from '@material-ui/core/Box';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nimport axios from 'axios';\nimport { getToken } from '../../Utils/Common';\nimport dateFormat from 'dateformat';\nconst useStyles = makeStyles(() => ({\n  searchButton: {\n    marginTop: 5,\n    backgroundColor: 'navy',\n    color: 'white',\n    '&:hover': {\n      background: \"white\",\n      color: 'navy'\n    }\n  },\n  datePicker: {\n    marginTop: 5,\n    marginBottom: 5\n  }\n}));\nconst defaultProps = {\n  bgcolor: 'background.paper',\n  m: 1,\n  border: 2,\n  padding: 2,\n  borderRadius: 16,\n  borderColor: 'navy'\n};\nexport default function GetServiceReport(props) {\n  const classes = useStyles();\n  const [serviceReport, setServiceReport] = useState([]);\n  const [agencyId, setAgencyId] = useState(\"\");\n  const [agencyErrorMsg, setAgencyErrorMsg] = useState(\"\");\n  const [serverErrorMsg, setServerErrorMsg] = useState(\"\");\n  const [startDate, setStartDate] = useState(dateFormat(new Date(), \"yyyy-mm-dd\"));\n  const [endDate, setEndDate] = useState(dateFormat(new Date(), \"yyyy-mm-dd\"));\n  const [reservationSum, setReservationSum] = useState(0);\n  const [loaded, setLoaded] = useState(false);\n  let reportElement = \"\";\n  let token = getToken();\n\n  const axiosGetServiceReport = query => {\n    axios.get(\"http://localhost:3001/servicereport?\" + query, {\n      headers: {\n        token: token\n      }\n    }).then(function (response) {\n      console.log(response);\n      setServiceReport(response.data.serviceReport);\n      setLoaded(true);\n    }).catch(function (error) {\n      console.log(error);\n      setServerErrorMsg(error);\n    });\n  };\n\n  if (loaded) {\n    let sum = 0;\n\n    for (let i = 0; i < serviceReport.length; i++) {\n      sum += serviceReport[i].price;\n    }\n\n    setReservationSum(sum);\n    console.log(sum);\n    setLoaded(false);\n  }\n\n  const handlePostClicked = () => {\n    let query = \"\";\n    let agencyError;\n\n    if (agencyId == \"\") {\n      agencyError = true;\n      setAgencyErrorMsg(\"Please select an agency\");\n    } else {\n      query += \"agency_id=\" + agencyId + \"&\";\n      agencyError = false;\n      setAgencyErrorMsg(\"\");\n    }\n\n    if (startDate != \"\" && endDate != \"\") {\n      query += \"startDate=\" + startDate + \"&endDate=\" + endDate;\n    }\n\n    if (!agencyError) {\n      axiosGetServiceReport(query);\n    }\n  };\n\n  if (serviceReport.length !== 0) {\n    reportElement = React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      style: {\n        color: \"green\",\n        fontWeight: 900,\n        fontSize: 16\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \"Reservations: \", serviceReport.length), React.createElement(\"p\", {\n      style: {\n        color: \"green\",\n        fontWeight: 900,\n        fontSize: 16\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, \"Total Sum: \", reservationSum, \"\\u20AC\"));\n  }\n\n  return React.createElement(Box, Object.assign({\n    borderColor: \"navy\"\n  }, defaultProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }), React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, \"Service Reports\"), React.createElement(\"div\", {\n    style: {\n      display: \"flex\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, React.createElement(GetAgencies, {\n    agencyId: agencyId,\n    setAgencyId: setAgencyId,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }), React.createElement(Paper, {\n    className: classes.datePicker,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(MuiPickersUtilsProvider, {\n    utils: DateFnsUtils,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"dd/MM/yyyy\",\n    margin: \"normal\",\n    id: \"start_date\",\n    label: \"Start date\",\n    value: startDate,\n    onChange: date => setStartDate(dateFormat(date, \"yyyy-mm-dd\")),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }), React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"dd/MM/yyyy\",\n    margin: \"normal\",\n    id: \"end_date\",\n    label: \"End date\",\n    value: endDate,\n    onChange: date => setEndDate(dateFormat(date, \"yyyy-mm-dd\")),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  })), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  })))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, React.createElement(Button, {\n    variant: \"contained\",\n    className: classes.searchButton,\n    onClick: () => handlePostClicked(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, \"Search\"), React.createElement(\"p\", {\n    style: {\n      color: \"red\",\n      fontWeight: 900,\n      fontSize: 16,\n      marginLeft: 130\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, serverErrorMsg, agencyErrorMsg)), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(TableContainer, {\n    component: Paper,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, React.createElement(Table, {\n    className: classes.table,\n    \"aria-label\": \"customized table\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, React.createElement(TableHead, {\n    className: classes.tableHeader,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, React.createElement(TableRow, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, \"Service Name\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, \"Customer\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, \"Price per day\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, \"Total price\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, \"Paid\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, \"Agency\"), React.createElement(TableCell, {\n    className: classes.tableHeaderCell,\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, \"Reservation Date\"))), React.createElement(TableBody, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, serviceReport.map((report, i) => React.createElement(TableRow, {\n    key: i,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, report.service), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, report.firstname, \" \", report.lastname), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, report.price, \"\\u20AC\"), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, report.sum, \"\\u20AC\"), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, reservation.paid === 1 ? \"Yes\" : \"No\"), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, report.agency), React.createElement(TableCell, {\n    align: \"left\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, report.reservationdate)))))), reportElement));\n}","map":{"version":3,"sources":["C:/Users/Pauli/Desktop/groupC/Frontend/vp-app/src/components/getServiceReport/GetServiceReport.js"],"names":["React","useState","useEffect","makeStyles","Button","GetAgencies","MuiPickersUtilsProvider","KeyboardDatePicker","DateFnsUtils","Box","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","axios","getToken","dateFormat","useStyles","searchButton","marginTop","backgroundColor","color","background","datePicker","marginBottom","defaultProps","bgcolor","m","border","padding","borderRadius","borderColor","GetServiceReport","props","classes","serviceReport","setServiceReport","agencyId","setAgencyId","agencyErrorMsg","setAgencyErrorMsg","serverErrorMsg","setServerErrorMsg","startDate","setStartDate","Date","endDate","setEndDate","reservationSum","setReservationSum","loaded","setLoaded","reportElement","token","axiosGetServiceReport","query","get","headers","then","response","console","log","data","catch","error","sum","i","length","price","handlePostClicked","agencyError","fontWeight","fontSize","display","date","marginLeft","table","tableHeader","tableHeaderCell","map","report","service","firstname","lastname","reservation","paid","agency","reservationdate"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport GetAgencies from '../getAgencies/GetAgencies';\r\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\nimport Box from '@material-ui/core/Box';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport axios from 'axios';\r\nimport { getToken } from '../../Utils/Common';\r\nimport dateFormat from 'dateformat';\r\n\r\nconst useStyles = makeStyles(() => ({\r\n    searchButton: {\r\n        marginTop: 5,\r\n        backgroundColor: 'navy',\r\n        color: 'white',\r\n        '&:hover': {\r\n            background: \"white\",\r\n            color: 'navy',\r\n        },\r\n    },\r\n    datePicker: {\r\n        marginTop: 5,\r\n        marginBottom: 5\r\n    }\r\n}));\r\nconst defaultProps = {\r\n    bgcolor: 'background.paper',\r\n    m: 1,\r\n    border: 2,\r\n    padding: 2,\r\n    borderRadius: 16,\r\n    borderColor: 'navy'\r\n\r\n};\r\n\r\nexport default function GetServiceReport(props) {\r\n\r\n    const classes = useStyles();\r\n    const [serviceReport, setServiceReport] = useState([]);\r\n    const [agencyId, setAgencyId] = useState(\"\");\r\n    const [agencyErrorMsg, setAgencyErrorMsg] = useState(\"\");\r\n    const [serverErrorMsg, setServerErrorMsg] = useState(\"\");\r\n    const [startDate, setStartDate] = useState(dateFormat(new Date(), \"yyyy-mm-dd\"));\r\n    const [endDate, setEndDate] = useState(dateFormat(new Date(), \"yyyy-mm-dd\"));\r\n    const [reservationSum, setReservationSum] = useState(0);\r\n    const [loaded, setLoaded] = useState(false);\r\n\r\n    let reportElement = \"\";\r\n    let token = getToken();\r\n\r\n    const axiosGetServiceReport = (query) => {\r\n        axios.get(\"http://localhost:3001/servicereport?\" + query, {\r\n            headers: {\r\n                token: token\r\n            }\r\n        }).then(function (response) { \r\n            console.log(response);\r\n            setServiceReport(response.data.serviceReport);\r\n            setLoaded(true);\r\n        })\r\n            .catch(function (error) {\r\n                console.log(error);\r\n                setServerErrorMsg(error);\r\n            })\r\n    }\r\n    if (loaded) {\r\n        let sum = 0;\r\n        for (let i = 0; i < serviceReport.length; i++) {\r\n            sum += serviceReport[i].price;\r\n        }\r\n        setReservationSum(sum);\r\n        console.log(sum);\r\n        setLoaded(false);\r\n    }\r\n\r\n    const handlePostClicked = () => {\r\n        let query = \"\";\r\n        let agencyError;\r\n        if (agencyId == \"\") {\r\n            agencyError = true;\r\n            setAgencyErrorMsg(\"Please select an agency\");\r\n        }\r\n        else {\r\n            query += \"agency_id=\" + agencyId + \"&\";\r\n            agencyError = false;\r\n            setAgencyErrorMsg(\"\");\r\n        }\r\n        if (startDate != \"\" && endDate != \"\") {\r\n\r\n            query += \"startDate=\" + startDate + \"&endDate=\" + endDate;\r\n        }\r\n        if (!agencyError) {\r\n            axiosGetServiceReport(query);\r\n        }\r\n    }\r\n\r\n    if (serviceReport.length !== 0) {\r\n        reportElement = <div>\r\n            <p style={{ color: \"green\", fontWeight: 900, fontSize: 16 }}>Reservations: {serviceReport.length}</p>\r\n            <p style={{ color: \"green\", fontWeight: 900, fontSize: 16 }}>Total Sum: {reservationSum}€</p>\r\n        </div>\r\n    }\r\n\r\n    return (\r\n\r\n        <Box borderColor=\"navy\" {...defaultProps}>\r\n            <h2>Service Reports</h2>\r\n            <div style={{ display: \"flex\" }}>\r\n                <div>\r\n                    <GetAgencies agencyId={agencyId} setAgencyId={setAgencyId} />\r\n                    <br />\r\n                    <Paper className={classes.datePicker}>\r\n                        <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n                            <KeyboardDatePicker\r\n                                disableToolbar\r\n                                variant=\"inline\"\r\n                                format=\"dd/MM/yyyy\"\r\n                                margin=\"normal\"\r\n                                id=\"start_date\"\r\n                                label=\"Start date\"\r\n                                value={startDate}\r\n                                onChange={(date) => setStartDate(dateFormat(date, \"yyyy-mm-dd\"))}\r\n                                KeyboardButtonProps={{\r\n                                    'aria-label': 'change date',\r\n                                }}\r\n                            />\r\n                            <KeyboardDatePicker\r\n                                disableToolbar\r\n                                variant=\"inline\"\r\n                                format=\"dd/MM/yyyy\"\r\n                                margin=\"normal\"\r\n                                id=\"end_date\"\r\n                                label=\"End date\"\r\n                                value={endDate}\r\n                                onChange={(date) => setEndDate(dateFormat(date, \"yyyy-mm-dd\"))}\r\n                                KeyboardButtonProps={{\r\n                                    'aria-label': 'change date',\r\n                                }}\r\n                            />\r\n                        </MuiPickersUtilsProvider><br />\r\n                    </Paper>\r\n                </div>\r\n            </div>\r\n            <div>\r\n                <Button variant=\"contained\" className={classes.searchButton} onClick={() => handlePostClicked()}>Search</Button>\r\n                <p style={{ color: \"red\", fontWeight: 900, fontSize: 16, marginLeft: 130 }}>{serverErrorMsg}{agencyErrorMsg}</p>\r\n            </div>\r\n            <div>\r\n                <TableContainer component={Paper}>\r\n                    <Table className={classes.table} aria-label=\"customized table\">\r\n                        <TableHead className={classes.tableHeader}>\r\n                            <TableRow>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Service Name</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Customer</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Price per day</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Total price</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Paid</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Agency</TableCell>\r\n                                <TableCell className={classes.tableHeaderCell} align=\"left\">Reservation Date</TableCell>\r\n                            </TableRow>\r\n                        </TableHead>\r\n                        <TableBody>\r\n                            {serviceReport.map((report, i) => <TableRow key={i}>\r\n                                <TableCell align=\"left\">{report.service}</TableCell>\r\n                                <TableCell align=\"left\">{report.firstname} {report.lastname}</TableCell>\r\n                                <TableCell align=\"left\">{report.price}€</TableCell>\r\n                                <TableCell align=\"left\">{report.sum}€</TableCell>\r\n                                <TableCell align=\"left\">{reservation.paid === 1 ? \"Yes\" : \"No\"}</TableCell>\r\n                                <TableCell align=\"left\">{report.agency}</TableCell>\r\n                                <TableCell align=\"left\">{report.reservationdate}</TableCell>\r\n                            </TableRow>)}\r\n                        </TableBody>\r\n                    </Table>\r\n                </TableContainer>\r\n                {reportElement}\r\n            </div>\r\n        </Box>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}