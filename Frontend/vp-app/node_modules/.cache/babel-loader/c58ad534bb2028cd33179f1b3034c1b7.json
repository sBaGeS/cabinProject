{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Pauli\\\\Desktop\\\\groupC\\\\Frontend\\\\vp-app\\\\src\\\\components\\\\bookCabin\\\\BookCabinDialog.js\";\nimport React, { useState } from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport NativeSelect from '@material-ui/core/NativeSelect';\nimport { getToken, getUserId } from '../../Utils/Common';\nimport axios from 'axios';\nimport dateFormat from 'dateformat';\nimport Box from '@material-ui/core/Box';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\nimport DateFnsUtils from '@date-io/date-fns';\nconst useStyles = makeStyles(theme => ({\n  formRoot: {\n    '& .MuiTextField-root': {\n      margin: theme.spacing(1),\n      width: '25ch'\n    }\n  },\n  Infotxt: {\n    color: 'yellow'\n  },\n  nativeSelect: {\n    margin: 8\n  }\n}));\nexport default function BookCabinDialog(props) {\n  const defaultProps = {\n    bgcolor: 'background.paper',\n    m: 1,\n    border: 2,\n    padding: 2,\n    borderRadius: 16\n  };\n  const token = getToken();\n  const user = getUserId();\n  const classes = useStyles();\n  const [arrivaldate, setArrivaldate] = useState(props.startDate);\n  const [leavedate, setLeavedate] = useState(props.endDate);\n  const startDate = dateFormat(arrivaldate, \"yyyy-mm-dd\");\n  const endDate = dateFormat(leavedate, \"yyyy-mm-dd\");\n  const [people, setPeople] = useState(\"\");\n  const [peopleErrorMsg, setPeopleErrorMsg] = useState(\"\");\n  const [invoice, setInvoice] = useState(\"\");\n  const [invoiceErrorMsg, setInvoiceErrorMsg] = useState(\"\");\n  const [pets, setPets] = useState(2);\n  const [petsErrorMsg, setPetsErrorMsg] = useState(\"\");\n  const [serverErrorMsg, setServerErrorMsg] = useState(\"\");\n  const [dialogOpen, setDialogOpen] = useState(true);\n  const [reserveMsg, setReserveMsg] = useState(\"\");\n\n  const date_diff_indays = function (date1, date2) {\n    let dt1 = new Date(date1);\n    let dt2 = new Date(date2);\n    return Math.floor((Date.UTC(dt2.getFullYear(), dt2.getMonth(), dt2.getDate()) - Date.UTC(dt1.getFullYear(), dt1.getMonth(), dt1.getDate())) / (1000 * 60 * 60 * 24));\n  };\n\n  let price = date_diff_indays(arrivaldate, leavedate) * props.price;\n\n  const axiosPostReservation = () => {\n    axios.post('http://localhost:3001/reservation/', {\n      arrivaldate: startDate,\n      leavedate: endDate,\n      people: people,\n      pets: pets,\n      person_id: user,\n      cabin_id: props.cabinId,\n      price: price,\n      invoice: invoice\n    }, {\n      headers: {\n        token: token\n      }\n    }).then(function (response) {\n      console.log(response);\n      setServerErrorMsg(\"\");\n      setReserveMsg(\"Cabin succesfully booked\");\n      setTimeout(() => {\n        setDialogOpen(false);\n        props.book(false);\n      }, 3500);\n    }).catch(function (error) {\n      console.log(error.response);\n      setServerErrorMsg(error.response.data.msg);\n      setTimeout(() => {\n        setServerErrorMsg(\"\");\n      }, 3500);\n    });\n  };\n\n  const handleClose = () => {\n    setReserveMsg(\"\");\n    setDialogOpen(false);\n    props.book(false);\n  };\n\n  const handleBookClicked = () => {\n    let petsValidationError = false;\n    let invoiceValidationError = false;\n    let peopleValidationError = false;\n\n    if (pets == 2) {\n      setPetsErrorMsg(\"Please select pets\");\n      petsValidationError = true;\n    } else {\n      petsValidationError = false;\n      setPetsErrorMsg(\"\");\n    }\n\n    if (invoice == 2) {\n      setInvoiceErrorMsg(\"Please select an invoice type\");\n      invoiceValidationError = true;\n    } else {\n      invoiceValidationError = false;\n      setInvoiceErrorMsg(\"\");\n    }\n\n    if (people <= 0 || people == \"\") {\n      setPeopleErrorMsg(\"Please insert the number of people\");\n      peopleValidationError = true;\n    } else {\n      peopleValidationError = false;\n      setPeopleErrorMsg(\"\");\n    }\n\n    if (petsValidationError === false && peopleValidationError === false && invoiceValidationError === false) {\n      axiosPostReservation();\n    }\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(Dialog, {\n    open: dialogOpen,\n    onClose: handleClose,\n    \"aria-labelledby\": \"form-dialog-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(DialogTitle, {\n    id: \"form-dialog-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, \"Book cabin\"), React.createElement(DialogContent, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, React.createElement(MuiPickersUtilsProvider, {\n    utils: DateFnsUtils,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"dd/MM/yyyy\",\n    margin: \"normal\",\n    id: \"start_date\",\n    label: \"Check in\",\n    disablePast: \"true\",\n    value: arrivaldate,\n    onChange: date => setArrivaldate(date),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }), React.createElement(KeyboardDatePicker, {\n    disableToolbar: true,\n    variant: \"inline\",\n    format: \"dd/MM/yyyy\",\n    margin: \"normal\",\n    id: \"end_date\",\n    label: \"Check out\",\n    disablePast: \"true\",\n    value: leavedate,\n    onChange: date => setLeavedate(date),\n    KeyboardButtonProps: {\n      'aria-label': 'change date'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  })), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }), React.createElement(\"form\", {\n    className: classes.formRoot,\n    noValidate: true,\n    autoComplete: \"off\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    error: peopleErrorMsg != \"\",\n    helperText: peopleErrorMsg,\n    required: true,\n    id: \"people\",\n    label: \"People\",\n    value: people,\n    type: \"number\",\n    onChange: e => {\n      setPeople(e.target.value);\n      e.target.value.length === 0 ? setPeopleErrorMsg(\"Please insert the number of people\") : setPeopleErrorMsg(\"\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }), React.createElement(NativeSelect, {\n    className: classes.nativeSelect,\n    required: true,\n    id: \"pets\",\n    label: \"Pets\",\n    error: petsErrorMsg != \"\",\n    helperText: petsErrorMsg,\n    defaultValue: \"2\",\n    onChange: e => {\n      setPets(parseInt(e.target.value, 10));\n      e.target.value == 2 ? setPetsErrorMsg(\"Please select pets\") : setPetsErrorMsg(\"\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    disabled: true,\n    value: \"2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }, \"Pets?\"), React.createElement(\"option\", {\n    value: \"1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, \"Yes\"), React.createElement(\"option\", {\n    value: \"0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209\n    },\n    __self: this\n  }, \"No\")), React.createElement(NativeSelect, {\n    required: true,\n    id: \"invoice\",\n    label: \"Invoice\",\n    error: invoiceErrorMsg != \"\",\n    helperText: invoiceErrorMsg,\n    defaultValue: \"2\",\n    onChange: e => {\n      setInvoice(parseInt(e.target.value, 10));\n      e.target.value == 2 ? setInvoiceErrorMsg(\"Please select invoice type\") : setInvoiceErrorMsg(\"\");\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    disabled: true,\n    value: \"2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, \"Invoice type\"), React.createElement(\"option\", {\n    value: \"1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, \"Email\"), React.createElement(\"option\", {\n    value: \"0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220\n    },\n    __self: this\n  }, \"Letter\")), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222\n    },\n    __self: this\n  })), React.createElement(Box, Object.assign({\n    borderColor: \"darkgreen\"\n  }, defaultProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }), React.createElement(\"p\", {\n    style: {\n      color: \"navy\",\n      fontWeight: 900,\n      fontSize: 16,\n      marginLeft: 115\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, \"Total price: \", price, \"\\u20AC\"))), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    style: {\n      color: \"red\",\n      fontWeight: 900,\n      fontSize: 14,\n      marginLeft: 120\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233\n    },\n    __self: this\n  }, serverErrorMsg), React.createElement(\"p\", {\n    style: {\n      color: \"darkgreen\",\n      fontWeight: 900,\n      fontSize: 16,\n      marginLeft: 125\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234\n    },\n    __self: this\n  }, reserveMsg), React.createElement(DialogActions, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  }, React.createElement(Button, {\n    variant: \"contained\",\n    onClick: () => handleBookClicked(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  }, \"Book\"), React.createElement(Button, {\n    variant: \"contained\",\n    onClick: () => handleClose(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238\n    },\n    __self: this\n  }, \"Close\")))));\n}","map":{"version":3,"sources":["C:/Users/Pauli/Desktop/groupC/Frontend/vp-app/src/components/bookCabin/BookCabinDialog.js"],"names":["React","useState","TextField","makeStyles","Button","Dialog","DialogActions","DialogContent","DialogTitle","NativeSelect","getToken","getUserId","axios","dateFormat","Box","MuiPickersUtilsProvider","KeyboardDatePicker","DateFnsUtils","useStyles","theme","formRoot","margin","spacing","width","Infotxt","color","nativeSelect","BookCabinDialog","props","defaultProps","bgcolor","m","border","padding","borderRadius","token","user","classes","arrivaldate","setArrivaldate","startDate","leavedate","setLeavedate","endDate","people","setPeople","peopleErrorMsg","setPeopleErrorMsg","invoice","setInvoice","invoiceErrorMsg","setInvoiceErrorMsg","pets","setPets","petsErrorMsg","setPetsErrorMsg","serverErrorMsg","setServerErrorMsg","dialogOpen","setDialogOpen","reserveMsg","setReserveMsg","date_diff_indays","date1","date2","dt1","Date","dt2","Math","floor","UTC","getFullYear","getMonth","getDate","price","axiosPostReservation","post","person_id","cabin_id","cabinId","headers","then","response","console","log","setTimeout","book","catch","error","data","msg","handleClose","handleBookClicked","petsValidationError","invoiceValidationError","peopleValidationError","date","e","target","value","length","parseInt","fontWeight","fontSize","marginLeft"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport NativeSelect from '@material-ui/core/NativeSelect';\r\nimport {getToken, getUserId} from '../../Utils/Common';\r\nimport axios from 'axios';\r\nimport dateFormat from 'dateformat';\r\nimport Box from '@material-ui/core/Box';\r\nimport {MuiPickersUtilsProvider,KeyboardDatePicker} from '@material-ui/pickers';\r\nimport DateFnsUtils from '@date-io/date-fns';\r\n\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    formRoot: {\r\n        '& .MuiTextField-root': {\r\n            margin: theme.spacing(1),\r\n            width: '25ch',\r\n        }\r\n    },\r\n    Infotxt: {\r\n        color: 'yellow',\r\n    },\r\n    nativeSelect: {\r\n        margin: 8\r\n    }\r\n}));\r\n\r\nexport default function BookCabinDialog(props) {\r\n\r\n    const defaultProps = {\r\n        bgcolor: 'background.paper',\r\n        m: 1,\r\n        border: 2,\r\n        padding: 2,\r\n        borderRadius: 16\r\n    };\r\n\r\n    const token = getToken();\r\n    const user = getUserId();\r\n\r\n    const classes = useStyles();\r\n\r\n    const [arrivaldate, setArrivaldate] = useState(props.startDate);\r\n    const [leavedate, setLeavedate] = useState(props.endDate);\r\n\r\n    const startDate = dateFormat(arrivaldate, \"yyyy-mm-dd\");\r\n\r\n    const endDate = dateFormat(leavedate, \"yyyy-mm-dd\");\r\n\r\n    const [people, setPeople] = useState(\"\");\r\n    const [peopleErrorMsg, setPeopleErrorMsg] = useState(\"\");\r\n\r\n    const [invoice, setInvoice] = useState(\"\");\r\n    const [invoiceErrorMsg, setInvoiceErrorMsg]= useState(\"\");\r\n    \r\n    const [pets, setPets] = useState(2);\r\n    const [petsErrorMsg, setPetsErrorMsg] = useState(\"\");\r\n\r\n    const [serverErrorMsg, setServerErrorMsg] = useState(\"\");\r\n\r\n    const [dialogOpen, setDialogOpen] = useState(true);\r\n\r\n    const [reserveMsg, setReserveMsg] = useState(\"\");\r\n\r\n    const date_diff_indays = function(date1, date2) {\r\n        let dt1 = new Date(date1);\r\n        let dt2 = new Date(date2);\r\n        return Math.floor((Date.UTC(dt2.getFullYear(), dt2.getMonth(), dt2.getDate()) - Date.UTC(dt1.getFullYear(), dt1.getMonth(), dt1.getDate()) ) /(1000 * 60 * 60 * 24));\r\n        }\r\n\r\n    let price = date_diff_indays(arrivaldate, leavedate) * props.price;\r\n\r\n    const axiosPostReservation = () => {\r\n        axios.post('http://localhost:3001/reservation/', {\r\n            arrivaldate: startDate,\r\n            leavedate: endDate,\r\n            people: people,\r\n            pets: pets,\r\n            person_id: user,\r\n            cabin_id: props.cabinId,\r\n            price: price,\r\n            invoice: invoice\r\n        },\r\n            {\r\n                headers: {\r\n                    token: token\r\n                }\r\n            })\r\n            .then(function (response) {\r\n                console.log(response);\r\n                setServerErrorMsg(\"\");\r\n                setReserveMsg(\"Cabin succesfully booked\");\r\n                setTimeout(() => {\r\n                setDialogOpen(false);\r\n                props.book(false);  \r\n                }, 3500); \r\n            })\r\n            .catch(function (error) {\r\n                console.log(error.response);\r\n                setServerErrorMsg(error.response.data.msg);\r\n                setTimeout(() => {\r\n                   setServerErrorMsg(\"\");\r\n                }, 3500);\r\n            });\r\n    }\r\n\r\n    const handleClose = () => {\r\n        setReserveMsg(\"\");\r\n        setDialogOpen(false);\r\n        props.book(false);\r\n    };\r\n\r\n    const handleBookClicked = () => {\r\n        let petsValidationError = false;\r\n        let invoiceValidationError = false;\r\n        let peopleValidationError = false;\r\n\r\n        if (pets == 2) {\r\n            setPetsErrorMsg(\"Please select pets\");\r\n            petsValidationError = true;\r\n        }\r\n        else {\r\n            petsValidationError = false;\r\n            setPetsErrorMsg(\"\");\r\n        }\r\n\r\n        if (invoice == 2) {\r\n            setInvoiceErrorMsg(\"Please select an invoice type\");\r\n            invoiceValidationError = true;\r\n        }\r\n        else {\r\n            invoiceValidationError = false;\r\n            setInvoiceErrorMsg(\"\");\r\n        }\r\n        if (people <= 0 || people == \"\") {\r\n            setPeopleErrorMsg(\"Please insert the number of people\");\r\n            peopleValidationError = true;\r\n        }\r\n        else {\r\n            peopleValidationError = false;\r\n            setPeopleErrorMsg(\"\");\r\n        }\r\n\r\n        if (petsValidationError === false && peopleValidationError === false && invoiceValidationError === false) {\r\n            axiosPostReservation();\r\n        }\r\n    }\r\n\r\nreturn (\r\n    <div>\r\n        <Dialog open={dialogOpen} onClose={handleClose} aria-labelledby=\"form-dialog-title\">\r\n            <DialogTitle id=\"form-dialog-title\">Book cabin</DialogTitle>\r\n            <DialogContent>\r\n               \r\n\r\n                <MuiPickersUtilsProvider utils={DateFnsUtils}>\r\n            <KeyboardDatePicker\r\n          disableToolbar\r\n          variant=\"inline\"\r\n          format=\"dd/MM/yyyy\"\r\n          margin=\"normal\"\r\n          id=\"start_date\"\r\n          label=\"Check in\"\r\n          disablePast = \"true\"\r\n          value={arrivaldate}\r\n          onChange={(date) => setArrivaldate(date)}\r\n          KeyboardButtonProps={{\r\n            'aria-label': 'change date',\r\n          }}\r\n        />\r\n        \r\n         <KeyboardDatePicker\r\n          disableToolbar\r\n          variant=\"inline\"\r\n          format=\"dd/MM/yyyy\"\r\n          margin=\"normal\"\r\n          id=\"end_date\"\r\n          label=\"Check out\"\r\n          disablePast = \"true\"\r\n          value={leavedate}\r\n          onChange={(date) => setLeavedate(date)}\r\n          KeyboardButtonProps={{\r\n            'aria-label': 'change date',\r\n          }}\r\n        />\r\n         </MuiPickersUtilsProvider>\r\n          <br/>\r\n          <form className={classes.formRoot} noValidate autoComplete=\"off\">\r\n                <TextField error={peopleErrorMsg != \"\"} helperText={peopleErrorMsg} required id=\"people\" label=\"People\" value={people}\r\n                    type=\"number\"\r\n                    onChange={(e) => {\r\n                        setPeople(e.target.value);\r\n                        (e.target.value.length === 0) ? setPeopleErrorMsg(\"Please insert the number of people\") : setPeopleErrorMsg(\"\")\r\n                    }} />\r\n                    <br/>\r\n                <NativeSelect className = {classes.nativeSelect}\r\n                 required id=\"pets\" label=\"Pets\" error={petsErrorMsg != \"\"} helperText={petsErrorMsg} defaultValue=\"2\"\r\n                  onChange={(e) => {\r\n                      setPets(parseInt(e.target.value, 10));\r\n                      (e.target.value == 2) ? setPetsErrorMsg(\"Please select pets\") : setPetsErrorMsg(\"\")\r\n                  }}>\r\n                 <option disabled value=\"2\">Pets?</option>\r\n                 <option value=\"1\">Yes</option>\r\n                 <option value=\"0\">No</option>\r\n                </NativeSelect>\r\n                \r\n          <NativeSelect\r\n                 required id=\"invoice\" label=\"Invoice\" error={invoiceErrorMsg != \"\"} helperText={invoiceErrorMsg} defaultValue=\"2\"\r\n                  onChange={(e) => {\r\n                      setInvoice(parseInt(e.target.value, 10));\r\n                      (e.target.value == 2) ? setInvoiceErrorMsg(\"Please select invoice type\") : setInvoiceErrorMsg(\"\")\r\n                  }}>\r\n                 <option disabled value=\"2\">Invoice type</option>\r\n                 <option value=\"1\">Email</option>\r\n                 <option value=\"0\">Letter</option>\r\n                </NativeSelect>\r\n                <br />\r\n            </form>\r\n\r\n            <Box borderColor=\"darkgreen\" {...defaultProps}> \r\n            \r\n                <p style={{ color: \"navy\", fontWeight: 900, fontSize: 16, marginLeft: 115 }}>Total price: {price}€</p>\r\n\r\n            </Box>\r\n            </DialogContent>\r\n\r\n            <div>\r\n                <p style={{ color: \"red\", fontWeight: 900, fontSize: 14, marginLeft: 120 }}>{serverErrorMsg}</p>\r\n                <p style={{ color: \"darkgreen\", fontWeight: 900, fontSize: 16, marginLeft: 125 }}>{reserveMsg}</p>\r\n\r\n                <DialogActions>\r\n                    <Button variant=\"contained\" onClick={() => handleBookClicked()}>Book</Button>\r\n                    <Button variant=\"contained\" onClick={() => handleClose()}>Close</Button>\r\n                </DialogActions>\r\n            </div>\r\n        </Dialog>\r\n    </div>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}