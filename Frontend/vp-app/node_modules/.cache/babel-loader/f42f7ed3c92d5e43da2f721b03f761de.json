{"ast":null,"code":"// return the token from the session storage\nexport const getUser = () => {\n  return sessionStorage.getItem('user_username') || null;\n};\nexport const getUserId = () => {\n  return sessionStorage.getItem('user_id') || null;\n};\nexport const getToken = () => {\n  checkTokenExp();\n  return sessionStorage.getItem('token') || null;\n};\nexport const getAdmin = () => {\n  checkTokenExp();\n  let admin = sessionStorage.getItem('user_role');\n\n  if (admin == 1) {\n    return true;\n  } else {\n    return false;\n  }\n}; // remove the token and user from the session storage\n\nexport const removeUserSession = () => {\n  sessionStorage.removeItem('token');\n  sessionStorage.removeItem('user_id');\n  sessionStorage.removeItem('user_username');\n  sessionStorage.removeItem('user_role');\n  sessionStorage.removeItem('token_exp');\n}; // set the token and user from the session storage\n\nexport const setUserSession = token => {\n  let user = parseJwt(token);\n  console.log(user);\n  sessionStorage.setItem('user_id', user.id);\n  sessionStorage.setItem('user_username', user.username);\n  sessionStorage.setItem('user_role', user.role);\n  sessionStorage.setItem('token', token);\n  sessionStorage.setItem('token_exp', new Date(user.exp * 1000));\n};\nexport const checkTokenExp = () => {\n  let tokenExpTime = new Date(sessionStorage.getItem('token_exp'));\n  let timeNow = new Date();\n\n  if (timeNow > tokenExpTime) {\n    removeUserSession();\n  }\n};\n\nfunction parseJwt(token) {\n  var base64Url = token.split('.')[1];\n  var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n  var jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {\n    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n  }).join(''));\n  return JSON.parse(jsonPayload);\n}\n\n;","map":{"version":3,"sources":["C:/Users/Pauli/Desktop/groupC/Frontend/vp-app/src/Utils/Common.js"],"names":["getUser","sessionStorage","getItem","getUserId","getToken","checkTokenExp","getAdmin","admin","removeUserSession","removeItem","setUserSession","token","user","parseJwt","console","log","setItem","id","username","role","Date","exp","tokenExpTime","timeNow","base64Url","split","base64","replace","jsonPayload","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","JSON","parse"],"mappings":"AAAA;AACA,OAAO,MAAMA,OAAO,GAAG,MAAM;AAC3B,SAAOC,cAAc,CAACC,OAAf,CAAuB,eAAvB,KAA2C,IAAlD;AACD,CAFM;AAGP,OAAO,MAAMC,SAAS,GAAG,MAAM;AAC7B,SAAOF,cAAc,CAACC,OAAf,CAAuB,SAAvB,KAAqC,IAA5C;AACD,CAFM;AAGP,OAAO,MAAME,QAAQ,GAAG,MAAM;AAC5BC,EAAAA,aAAa;AACb,SAAOJ,cAAc,CAACC,OAAf,CAAuB,OAAvB,KAAmC,IAA1C;AACD,CAHM;AAIP,OAAO,MAAMI,QAAQ,GAAG,MAAM;AAC5BD,EAAAA,aAAa;AACb,MAAIE,KAAK,GAAGN,cAAc,CAACC,OAAf,CAAuB,WAAvB,CAAZ;;AAEA,MAAGK,KAAK,IAAI,CAAZ,EAAc;AACZ,WAAO,IAAP;AACD,GAFD,MAGI;AACF,WAAO,KAAP;AACD;AACF,CAVM,C,CAWP;;AACA,OAAO,MAAMC,iBAAiB,GAAG,MAAM;AACrCP,EAAAA,cAAc,CAACQ,UAAf,CAA0B,OAA1B;AACAR,EAAAA,cAAc,CAACQ,UAAf,CAA0B,SAA1B;AACAR,EAAAA,cAAc,CAACQ,UAAf,CAA0B,eAA1B;AACAR,EAAAA,cAAc,CAACQ,UAAf,CAA0B,WAA1B;AACAR,EAAAA,cAAc,CAACQ,UAAf,CAA0B,WAA1B;AACD,CANM,C,CAQP;;AACA,OAAO,MAAMC,cAAc,GAAIC,KAAD,IAAW;AACvC,MAAIC,IAAI,GAAGC,QAAQ,CAACF,KAAD,CAAnB;AACAG,EAAAA,OAAO,CAACC,GAAR,CAAYH,IAAZ;AACAX,EAAAA,cAAc,CAACe,OAAf,CAAuB,SAAvB,EAAkCJ,IAAI,CAACK,EAAvC;AACAhB,EAAAA,cAAc,CAACe,OAAf,CAAuB,eAAvB,EAAwCJ,IAAI,CAACM,QAA7C;AACAjB,EAAAA,cAAc,CAACe,OAAf,CAAuB,WAAvB,EAAoCJ,IAAI,CAACO,IAAzC;AACAlB,EAAAA,cAAc,CAACe,OAAf,CAAuB,OAAvB,EAAgCL,KAAhC;AACAV,EAAAA,cAAc,CAACe,OAAf,CAAuB,WAAvB,EAAqC,IAAII,IAAJ,CAASR,IAAI,CAACS,GAAL,GAAW,IAApB,CAArC;AACD,CARM;AASP,OAAO,MAAMhB,aAAa,GAAG,MAAM;AACjC,MAAIiB,YAAY,GAAG,IAAIF,IAAJ,CAASnB,cAAc,CAACC,OAAf,CAAuB,WAAvB,CAAT,CAAnB;AACA,MAAIqB,OAAO,GAAG,IAAIH,IAAJ,EAAd;;AAEA,MAAIG,OAAO,GAAGD,YAAd,EAA4B;AAC1Bd,IAAAA,iBAAiB;AAClB;AACF,CAPM;;AASP,SAASK,QAAT,CAAkBF,KAAlB,EAAyB;AACvB,MAAIa,SAAS,GAAGb,KAAK,CAACc,KAAN,CAAY,GAAZ,EAAiB,CAAjB,CAAhB;AACA,MAAIC,MAAM,GAAGF,SAAS,CAACG,OAAV,CAAkB,IAAlB,EAAwB,GAAxB,EAA6BA,OAA7B,CAAqC,IAArC,EAA2C,GAA3C,CAAb;AACA,MAAIC,WAAW,GAAGC,kBAAkB,CAACC,IAAI,CAACJ,MAAD,CAAJ,CAAaD,KAAb,CAAmB,EAAnB,EAAuBM,GAAvB,CAA2B,UAAUC,CAAV,EAAa;AAC3E,WAAO,MAAM,CAAC,OAAOA,CAAC,CAACC,UAAF,CAAa,CAAb,EAAgBC,QAAhB,CAAyB,EAAzB,CAAR,EAAsCC,KAAtC,CAA4C,CAAC,CAA7C,CAAb;AACD,GAFoC,EAElCC,IAFkC,CAE7B,EAF6B,CAAD,CAApC;AAIA,SAAOC,IAAI,CAACC,KAAL,CAAWV,WAAX,CAAP;AACD;;AAAA","sourcesContent":["// return the token from the session storage\r\nexport const getUser = () => {\r\n  return sessionStorage.getItem('user_username') || null;\r\n}\r\nexport const getUserId = () => {\r\n  return sessionStorage.getItem('user_id') || null;\r\n}\r\nexport const getToken = () => {\r\n  checkTokenExp()\r\n  return sessionStorage.getItem('token') || null;\r\n}\r\nexport const getAdmin = () => {\r\n  checkTokenExp()\r\n  let admin = sessionStorage.getItem('user_role');\r\n  \r\n  if(admin == 1){\r\n    return true;\r\n  }\r\n  else{\r\n    return false;\r\n  }\r\n}\r\n// remove the token and user from the session storage\r\nexport const removeUserSession = () => {\r\n  sessionStorage.removeItem('token');\r\n  sessionStorage.removeItem('user_id');\r\n  sessionStorage.removeItem('user_username');\r\n  sessionStorage.removeItem('user_role');\r\n  sessionStorage.removeItem('token_exp');\r\n}\r\n\r\n// set the token and user from the session storage\r\nexport const setUserSession = (token) => {\r\n  let user = parseJwt(token);\r\n  console.log(user);\r\n  sessionStorage.setItem('user_id', user.id);\r\n  sessionStorage.setItem('user_username', user.username);\r\n  sessionStorage.setItem('user_role', user.role);\r\n  sessionStorage.setItem('token', token);\r\n  sessionStorage.setItem('token_exp', (new Date(user.exp * 1000)));\r\n}\r\nexport const checkTokenExp = () => {\r\n  let tokenExpTime = new Date(sessionStorage.getItem('token_exp'));\r\n  let timeNow = new Date();\r\n  \r\n  if (timeNow > tokenExpTime) {\r\n    removeUserSession();\r\n  }\r\n}\r\n\r\nfunction parseJwt(token) {\r\n  var base64Url = token.split('.')[1];\r\n  var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n  var jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {\r\n    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n  }).join(''));\r\n\r\n  return JSON.parse(jsonPayload);\r\n};\r\n"]},"metadata":{},"sourceType":"module"}